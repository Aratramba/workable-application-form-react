var e,l,t,a,n=require("react/jsx-runtime"),r=require("react"),i=require("intl-tel-input"),s=require("react-dropzone"),o=require("@radix-ui/react-dialog"),d=require("@radix-ui/react-visually-hidden");e=module.exports,l="ApplicationForm",t=()=>F,Object.defineProperty(e,l,{get:t,set:a,enumerable:!0,configurable:!0});const c={telephoneInitialCountry:"US",telephonePreferredCountries:["us","gb","ca","de","au"],telephoneAllowDropdown:!0,telephoneAutoHideDialCode:!1,telephoneAutoPlaceholder:"polite",telephoneCustomContainer:"",telephoneCustomPlaceholder:null,telephoneDropdownContainer:null,telephoneExcludeCountries:[],telephoneFormatOnDisplay:!0,telephoneGeoIpLookup:null,telephoneHiddenInput:"",telephoneLocalizedCountries:null,telephoneNationalMode:!1,telephoneOnlyCountries:[],telephonePlaceholderNumberType:"MOBILE",telephoneSeparateDialCode:!0,labelForm:"Application",labelSubmit:"Submit application",labelAdd:"Add",labelSave:"Save",labelCancel:"Cancel",labelEdit:"Edit",labelDelete:"Delete",labelClose:"Close",labelOptional:"(optional)",labelClear:"Clear",labelDropzoneUpload:"Upload a file",labelDropzoneDragDrop:"or drag and drop here",labelDropzoneMaxSize:"Max file size is ",labelDropzoneAcceptableFileTypes:"Acceptable file types: ",labelDropzoneReplaceFile:"Replace file",labelDropzoneNoFilesAccepted:"No files accepted",labelDropzoneAborted:"File reading was aborted",labelDropzoneError:"File reading has failed",iconCancel:()=>(0,n.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,children:(0,n.jsx)("path",{d:"M7.7574 7.7574 12 12.0001m0 0 4.2426 4.2426M12 12.0001l4.2426-4.2427M12 12.0001l-4.2426 4.2426",stroke:"currentColor",strokeWidth:"1.5"})}),iconCheck:()=>(0,n.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,children:(0,n.jsx)("path",{d:"M6.5 12.5 10 16l7.5-7.5",stroke:"currentColor",strokeWidth:"1.5"})}),iconEdit:()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,children:[(0,n.jsx)("path",{fill:"none",stroke:"currentColor",strokeWidth:"1.5",d:"M9 6.75H4.75v12.5h12.5V15"}),(0,n.jsx)("path",{fill:"none",stroke:"currentColor",strokeWidth:"1.5",d:"M17.5 4.25l-7.25 7.25v2.75H13l7.24-7.26 -2.75-2.75Z"})]}),iconDelete:()=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,children:(0,n.jsx)("path",{fill:"none",stroke:"currentColor",strokeWidth:"1.5",d:"M7.25 7.75h9.5m-9.5 0v10.5h9.5V7.75m-9.5 0H5m11.75 0H19m-4.75 0v-3h-4.5v3"})}),iconClear:()=>(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:24,height:24,children:(0,n.jsx)("path",{fill:"none",stroke:"currentColor",strokeWidth:"1.5",d:"M7.25 7.75h9.5m-9.5 0v10.5h9.5V7.75m-9.5 0H5m11.75 0H19m-4.75 0v-3h-4.5v3"})})},u=r.createContext(c),p=({label:e,required:l,id:t})=>{const a=r.useContext(u);return(0,n.jsx)("div",{className:"form-label-wrapper",children:(0,n.jsxs)("label",{className:"form-label",htmlFor:`workable-${t}`,children:[e,l?(0,n.jsx)("span",{className:"form-label__required",children:"*"}):(0,n.jsx)("span",{className:"form-label__optional",children:a.labelOptional})]})})},h=({required:e,id:l,label:t,defaultValue:a})=>{const i=(0,r.useContext)(u);return(0,n.jsxs)("div",{className:"toggle-wrapper",children:[(0,n.jsxs)("div",{className:"toggle",children:[(0,n.jsx)("input",{type:"checkbox",name:l,required:e,id:`workable-${l}`,className:"toggle__input",defaultChecked:Boolean(a)}),(0,n.jsx)("span",{className:"toggle__check",children:i.iconCheck()})]}),(0,n.jsx)(p,{label:t,id:l,required:e})]})},m=({children:e})=>(0,n.jsx)("div",{className:"form-field",children:(0,n.jsx)("div",{className:"form-field__wrapper",children:e})}),x=({count:e=0,maxLength:l})=>l?(0,n.jsxs)("span",{className:"form-field__maxlength",children:[e," / ",l]}):null,f=({required:e,id:l,defaultValue:t,maxLength:a})=>{const[i,s]=(0,r.useState)(null);return(0,n.jsxs)(m,{children:[(0,n.jsx)("input",{type:"text",name:l,required:e,id:`workable-${l}`,defaultValue:t,className:"form-field__text",maxLength:a,onChange:e=>s(e.target.value)}),(0,n.jsx)(x,{count:i?.length,maxLength:a})]})},b=({id:e,required:l,maxLength:t,defaultValue:a})=>{const[i,s]=(0,r.useState)(null);return(0,n.jsxs)(m,{children:[(0,n.jsx)("textarea",{name:e,required:l,id:`workable-${e}`,defaultValue:a,rows:5,className:"form-field__textarea",maxLength:t,onChange:e=>s(e.target.value)}),(0,n.jsx)(x,{count:i?.length,maxLength:t})]})},j=({children:e})=>(0,n.jsx)("div",{className:"form-item",children:e}),g=({required:e,id:l,defaultValue:t})=>(0,n.jsx)(m,{children:(0,n.jsx)("input",{type:"date",name:l,defaultValue:t,required:e,id:`workable-${l}`,className:"form-field__text form-field__date"})}),y=({required:e,id:l,maxLength:t,defaultValue:a})=>(0,n.jsx)(m,{children:(0,n.jsx)("input",{type:"number",name:l,defaultValue:a,required:e,id:`workable-${l}`,className:"form-field__text form-field__number",maxLength:t})}),_=({required:e,id:l,maxLength:t,defaultValue:a})=>{const s=(0,r.useRef)(null),o=(0,r.useContext)(u),[d,c]=(0,r.useState)("");return(0,r.useEffect)((()=>{if(!s.current)return;const e=((l=i)&&l.__esModule?l.default:l)(s.current,{initialCountry:o.telephoneInitialCountry,allowDropdown:o.telephoneAllowDropdown,autoHideDialCode:o.telephoneAutoHideDialCode,autoPlaceholder:o.telephoneAutoPlaceholder,customContainer:o.telephoneCustomContainer,customPlaceholder:o.telephoneCustomPlaceholder,dropdownContainer:o.telephoneDropdownContainer,excludeCountries:o.telephoneExcludeCountries,formatOnDisplay:o.telephoneFormatOnDisplay,geoIpLookup:o.telephoneGeoIpLookup,hiddenInput:o.telephoneHiddenInput,localizedCountries:o.telephoneLocalizedCountries,nationalMode:o.telephoneNationalMode,onlyCountries:o.telephoneOnlyCountries,placeholderNumberType:o.telephonePlaceholderNumberType,preferredCountries:o.telephonePreferredCountries,separateDialCode:o.telephoneSeparateDialCode,utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/utils.js"});var l;const t=()=>{const l=e.getSelectedCountryData();c(l.dialCode)};t(),s.current.addEventListener("countrychange",t)}),[]),(0,n.jsxs)(m,{children:[(0,n.jsx)("input",{type:"tel",ref:s,name:l,defaultValue:a,required:e,id:`workable-${l}`,maxLength:t,className:"form-field__text form-field__telephone"}),(0,n.jsx)("input",{type:"hidden",name:`${l}_dialcode`,value:d,readOnly:!0})]})};const v=({id:e,supportedFileTypes:l,maxFileSize:t})=>{const a=(0,r.useContext)(u),i=Boolean(l.filter((e=>["jpg","jpeg","gif","png"].includes(e))).length),[o,d]=(0,r.useState)("initial"),[c,p]=(0,r.useState)(null),[h,m]=(0,r.useState)(""),[x,f]=(0,r.useState)(""),{acceptedFiles:b,getRootProps:j,getInputProps:g,inputRef:y}=(0,s.useDropzone)({maxFiles:1,multiple:!1,maxSize:t,accept:{"application/octet-stream":l.map((e=>`.${e}`))},onDrop:e=>{if(d("loading"),!e.length)return m(a.labelDropzoneNoFilesAccepted),void d("error");e.forEach((e=>{const l=new FileReader;l.onabort=()=>{_(),m(a.labelDropzoneAborted),d("error")},l.onerror=()=>{_(),m(a.labelDropzoneError),d("error")},l.onload=()=>{f(l.result.toString().split("base64,")[1]),d("success")},l.readAsDataURL(e)})),p(e.map((e=>Object.assign(e,{preview:URL.createObjectURL(e)})))[0])}}),_=()=>{c&&URL.revokeObjectURL(c.preview),f("")};(0,r.useEffect)((()=>()=>_()),[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button","data-action":"remove-entry",onClick:e=>{e.preventDefault(),b.length=0,b.splice(0,b.length),y.current.value="",p(null),d("initial"),m("")},style:{display:"none"}}),(0,n.jsxs)("div",{...j({className:"dropzone"}),"data-state":o,children:[(0,n.jsx)("input",{...g()}),(0,n.jsx)("textarea",{name:e,style:{display:"none"},"data-filename":b?.[0]?.name,value:x,readOnly:!0}),b.length>0?(0,n.jsxs)(n.Fragment,{children:[i&&c&&(0,n.jsx)("img",{style:{maxWidth:240},src:c.preview,onLoad:()=>{URL.revokeObjectURL(c.preview)}},c.name),!i&&b.map((e=>(0,n.jsx)("p",{children:e.name},e.name))),(0,n.jsxs)("p",{className:"dropzone__label",children:[(0,n.jsx)("span",{children:a.labelDropzoneReplaceFile})," ",a.labelDropzoneDragDrop]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"dropzone__label",children:[(0,n.jsx)("span",{children:a.labelDropzoneUpload})," ",a.labelDropzoneDragDrop]}),(0,n.jsx)("p",{className:"dropzone__info",children:t&&`${a.labelDropzoneMaxSize} ${Math.floor(t/1e6)}Mb. Acceptable file types .\n              ${l.join(", .")}.`})]}),"loading"===o&&(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n                .spinner_b2T7{animation:spinner_xe7Q .8s linear infinite}.spinner_YRVV{animation-delay:-.65s}.spinner_c9oY{animation-delay:-.5s}@keyframes spinner_xe7Q{93.75%,100%{r:3px}46.875%{r:.2px}}"}}),(0,n.jsx)("circle",{className:"spinner_b2T7",cx:"4",cy:"12",r:"3"}),(0,n.jsx)("circle",{className:"spinner_b2T7 spinner_YRVV",cx:"12",cy:"12",r:"3"}),(0,n.jsx)("circle",{className:"spinner_b2T7 spinner_c9oY",cx:"20",cy:"12",r:"3"})]}),h&&(0,n.jsx)("p",{className:"dropzone__message",children:h})]})]})};const w=({onClick:e,theme:l="primary",type:t="button",size:a="md",children:r,style:i,disabled:s,className:o="",...d})=>(0,n.jsx)("button",{type:t,onClick:e,className:`button button--${l} button--${a} button--${s?"disabled":"enabled"} ${o}`,style:i,disabled:s,...d,children:r}),C=({name:e,children:l,displayClearButton:t=!0})=>{const a=(0,r.useContext)(u),i=(0,r.useRef)(null);return(0,n.jsxs)("fieldset",{className:"form-fieldset",ref:i,children:[e&&(0,n.jsxs)("legend",{className:"form-legend",children:[(0,n.jsx)("span",{className:"form-legend__title",children:e}),t&&(0,n.jsx)("span",{className:"form-legend__clear",children:(0,n.jsxs)(w,{type:"button",theme:"ghost",onClick:()=>{i.current.querySelectorAll("input, textarea, select").forEach((e=>{"checkbox"===e.type||"radio"===e.type?e.checked=!1:e.value="",e.dispatchEvent(new Event("change"))}));i.current.querySelectorAll('[data-action="remove-entry"]').forEach((e=>{e.click()}))},children:[a.iconClear(),a.labelClear]})})]}),l]})},k=({id:e,required:l,label:t,fields:a})=>{const i=(0,r.useContext)(u),[s,c]=(0,r.useState)("initial"),p=(0,r.useRef)(null),h=(0,r.useRef)(null),[m,x]=(0,r.useState)(null),f=(0,r.useRef)(0),[b,j]=(0,r.useReducer)(((e,l)=>{const t=e.findIndex((({id:e})=>e===l.id));let a=[...e];switch(l.type){case"add":return[...e,l];case"remove":return a.splice(t,1),a;case"edit":return a.splice(t,1,l),a}}),[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"hidden",name:e,value:JSON.stringify(b),ref:h,onChange:e=>j(JSON.parse(e.target.value))}),Boolean(b.length)&&(0,n.jsx)("div",{className:"complex-multiple__entries",children:b.map((e=>(0,n.jsxs)("div",{className:"complex-multiple__entry",children:[(0,n.jsx)("table",{className:"complex-multiple__entry-table",children:(0,n.jsx)("tbody",{children:Object.entries(e.data).map((([e,l])=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:l.label}),"on"===l.value?(0,n.jsx)("td",{children:i.iconCheck()}):(0,n.jsx)("td",{children:l.value})]},e)))})}),(0,n.jsxs)("div",{className:"complex-multiple__entry-actions",children:[(0,n.jsxs)(w,{type:"button",theme:"ghost",onClick:()=>{x(e.id),c("dialog")},children:[i.iconEdit(),(0,n.jsx)(d.Root,{children:i.labelEdit})]}),(0,n.jsxs)(w,{type:"button",theme:"ghost","data-action":"remove-entry",onClick:()=>j({id:e.id,type:"remove"}),children:[i.iconDelete(),(0,n.jsx)(d.Root,{children:i.labelDelete})]})]})]},e.id)))}),(0,n.jsx)("div",{className:"complex-multiple__add",children:(0,n.jsx)(w,{type:"button",onClick:()=>c("dialog"),children:i.labelAdd})}),(0,n.jsx)(o.Root,{open:"dialog"===s,children:(0,n.jsxs)(o.Portal,{children:[(0,n.jsx)(o.Overlay,{className:"dialog-overlay"}),(0,n.jsx)(o.Content,{className:"dialog-content application-form-dialog",onEscapeKeyDown:()=>c("initial"),onPointerDownOutside:()=>c("initial"),onInteractOutside:()=>c("initial"),children:(0,n.jsxs)("div",{className:"dialog-content__form",children:[(0,n.jsx)(d.Root,{asChild:!0,children:(0,n.jsx)(o.Title,{className:"dialog-title",children:m?i.labelEdit:i.labelAdd})}),(0,n.jsx)(w,{"aria-label":i.labelClose,onClick:()=>c("initial"),theme:"tertiary",className:"dialog-content__close",children:i.iconCancel()}),(0,n.jsx)("form",{className:"complex-multiple__form",ref:p,children:(0,n.jsxs)(C,{name:t,displayClearButton:!1,children:[a.map((e=>{const l={...b.find((({id:e})=>e===m))};return(0,n.jsx)(q,{name:e.id,field:{...e,defaultValue:m&&l?l.data[e.id]?.value:null}},e.id)})),(0,n.jsxs)("div",{className:"button-row",children:[(0,n.jsx)(w,{type:"button",onClick:()=>(()=>{if(!h.current)return;if(!p)return;const e=new FormData(p.current),l=Object.fromEntries(e.entries()),t=m?{id:m,type:"edit",data:{}}:{id:"entry-"+ ++f.current,type:"add",data:{}};Object.entries(l).forEach((([e,l])=>{const n=a.find((l=>l.id===e));l.trim().length&&(t.data[e]={key:e,value:l,label:n.label})})),j(t),c("initial"),x(null)})(),children:i.labelSave}),(0,n.jsx)(w,{type:"button",theme:"tertiary",onClick:()=>{x(null),c("initial")},children:i.labelCancel})]})]})})]})})]})})]})};const N=({required:e,id:l,options:t,defaultValue:a})=>(0,n.jsx)(m,{children:(0,n.jsxs)("select",{className:"form-field__select",name:l,required:e,id:`workable-${l}`,defaultValue:a,children:[(0,n.jsx)("option",{value:null}),t?.map((e=>(0,n.jsx)("option",{value:e.name,children:e.value},e.name)))]})}),D=({id:e,options:l,singleOption:t,defaultValue:a})=>(0,n.jsx)("fieldset",{className:"form-field__choice-fieldset",children:l?.map((l=>(0,n.jsxs)("div",{className:"form-field__choice-wrapper",children:[(0,n.jsx)("input",{type:t?"radio":"checkbox",name:e,id:`${e}${l.name}`,value:l.name,className:"form-field__choice",defaultChecked:Array.isArray(a)?a.includes(l.name):a===l.name}),(0,n.jsx)("label",{htmlFor:`${e}${l.name}`,children:l.value})]},l.name)))}),q=({name:e,field:l})=>{if(!l)return console.log(`Missing field: ${e}`),null;let t;switch(l.type){case"paragraph":t=()=>(0,n.jsx)(b,{...l});break;case"file":t=()=>(0,n.jsx)(v,{...l});break;case"boolean":t=()=>(0,n.jsx)(h,{...l});break;case"date":t=()=>(0,n.jsx)(g,{...l});break;case"multiple":t=()=>(0,n.jsx)(D,{...l});break;case"dropdown":t=()=>(0,n.jsx)(N,{...l});break;case"number":t=()=>(0,n.jsx)(y,{...l});break;case"group":t=()=>(0,n.jsx)(k,{...l});break;default:t=()=>(0,n.jsx)(f,{...l})}return"phone"===l.id&&(t=()=>(0,n.jsx)(_,{...l})),"boolean"===l.type?(0,n.jsx)(j,{children:t&&(0,n.jsx)(t,{})}):(0,n.jsxs)(j,{children:[(0,n.jsx)(p,{label:l.label,id:l.id,required:l.required}),t&&(0,n.jsx)(t,{}),l.helper&&(0,n.jsx)("p",{className:"form-helper",children:l.helper})]})},S=({children:e})=>(0,n.jsx)("div",{className:"button-row",children:e}),z=({children:e,as:l="h2"})=>{const t=l;return(0,n.jsx)(t,{className:`heading heading--${l}`,children:e})},O=({children:e,onSubmit:l})=>{const[t,a]=r.useState("initial"),[i,s]=r.useState(null),o=r.useContext(u);return(0,n.jsxs)("form",{className:`form--${t}`,onSubmit:e=>{a("saving"),s(null),l(e,(e=>{e?(s(e),a("error")):a("complete")}))},encType:"multipart/form-data",children:[o.labelForm&&(0,n.jsx)(z,{as:"h1",children:o.labelForm}),e,(0,n.jsx)("p",{className:"form__error "+(i?"enabled":"disabled"),onClick:()=>s(null),children:i})]})},E=e=>{const l={};return Object.keys(e).forEach((t=>{let a=e[t];try{a=JSON.parse(a)}catch(e){}Array.isArray(a)?l[t]=a.map((e=>{if("object"==typeof e&&null!==e){if("value"in a)return A(a.value);if("data"in e){const l={};return Object.keys(e.data).forEach((t=>{l[t]=A(e.data[t].value)})),l}return E(e)}return A(e)})):l[t]=A(a)})),l},A=e=>{if("string"!=typeof e||0!==e.trim().length)return"on"===e||"off"===e?"on"===e:e},L=(e,l)=>{const t={name:e.name,firstname:e.firstname,lastname:e.lastname,email:e.email,headline:e.headline,summary:e.summary,address:e.address,phone:e.phone?`+${e.phone_dialcode}${e.phone}`:void 0,cover_letter:e.cover_letter,education_entries:e.education,experience_entries:e.experience,answers:[],skills:e.skills,tags:e.tags,disqualified:e.disqualified,disqualification_reason:e.disqualification_reason,disqualified_at:e.disqualified_at,social_profiles:e.social_profiles,domain:e.domain,recruiter_key:e.recruiter_key};return l.filter((e=>!Object.keys(t).includes(e.id))).forEach((l=>{const a=e[l.id];if(a)switch(l.type){case"text":case"email":case"phone":case"paragraph":const e={question_key:l.id,body:a};t.answers.push(e);break;case"multiple":const n={question_key:l.id,choices:[a]};t.answers.push(n);break;case"boolean":const r={question_key:l.id,checked:a};t.answers.push(r);break;case"dropdown":const i={question_key:l.id,choices:[a]};t.answers.push(i);break;case"date":const s={question_key:l.id,date:a};t.answers.push(s);break;case"number":const o={question_key:l.id,value:+a};t.answers.push(o);break;case"file":const d={question_key:l.id,file:{name:l.id,data:a}};t.answers.push(d)}})),Object.keys(t).forEach((e=>void 0===t[e]?delete t[e]:{})),t},F=({config:e={},form:l=[],onSave:t=(()=>{})})=>{const a=l.reduce(((e,l)=>[...e,...l.fields]),[]);return(0,n.jsx)("div",{className:"application-form",children:(0,n.jsx)(u.Provider,{value:{...c,...e},children:(0,n.jsxs)(O,{onSubmit:(e,l)=>{e.preventDefault();const n=new FormData(e.currentTarget),r=Object.fromEntries(n.entries()),i={};Object.keys(r).forEach((e=>{const l=a.find((l=>l.id===e));i[e]="multiple"===l?.type||"dropdown"===l?.type?n.getAll(e):n.get(e)}));const s=E(i),o=L(s,a);return t(o,(e=>{e?l(e):l()})),!1},children:[l.map((e=>(0,n.jsx)(C,{name:e.name,children:e.fields.map((e=>(0,n.jsx)(q,{name:e.id,field:e},e.id)))},e.name))),(0,n.jsx)(C,{children:(0,n.jsx)(S,{children:(0,n.jsx)(w,{type:"submit",size:"lg",style:{width:"100%"},children:e.labelSubmit||c.labelSubmit})})})]})})})};
//# sourceMappingURL=main.js.map
